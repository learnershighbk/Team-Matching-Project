# ğŸ—ï¸ ARCHITECTURE.md â€” TeamMatch ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

**ì°¸ì¡°:** PRD.md  
**ë²„ì „:** v1.0  
**ìµœì¢… ì—…ë°ì´íŠ¸:** 2025-01-06

---

## 1. System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CLIENTS                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Admin     â”‚   Instructor    â”‚           Student               â”‚
â”‚  /admin     â”‚   /instructor   â”‚    /course/{uuid}               â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚               â”‚                        â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Next.js 14 (App Router)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    Middleware                            â”‚   â”‚
â”‚  â”‚              (JWT ê²€ì¦, Role ì²´í¬)                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  API Routes  â”‚  â”‚   Pages      â”‚  â”‚    Components        â”‚  â”‚
â”‚  â”‚  /api/*      â”‚  â”‚  App Router  â”‚  â”‚    UI Library        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Supabase                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ PostgreSQL  â”‚  â”‚    Auth     â”‚  â”‚      Storage            â”‚  â”‚
â”‚  â”‚  (Tables)   â”‚  â”‚  (ë¯¸ì‚¬ìš©)    â”‚  â”‚      (ë¯¸ì‚¬ìš©)            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Tech Stack

| Layer | Technology | Version | Purpose |
|-------|------------|---------|---------|
| **Frontend** | Next.js | 14.x | App Router, SSR/CSR |
| **Styling** | Tailwind CSS | 3.x | Utility-first CSS |
| **UI Components** | shadcn/ui | latest | ì¬ì‚¬ìš© ê°€ëŠ¥ ì»´í¬ë„ŒíŠ¸ |
| **Backend** | Next.js API Routes | 14.x | Serverless Functions |
| **Database** | Supabase (PostgreSQL) | latest | ë°ì´í„° ì €ì¥ |
| **Auth** | ìì²´ JWT | - | jose ë¼ì´ë¸ŒëŸ¬ë¦¬ |
| **Deployment** | Vercel | - | Edge Network |
| **Language** | TypeScript | 5.x | Type Safety |

---

## 3. Folder Structure

```
teammatch/
â”œâ”€â”€ app/                          # Next.js App Router
â”‚   â”œâ”€â”€ (auth)/                   # Auth ê·¸ë£¹ (ë ˆì´ì•„ì›ƒ ê³µìœ )
â”‚   â”‚   â”œâ”€â”€ admin/
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx          # Admin ë¡œê·¸ì¸
â”‚   â”‚   â”‚   â””â”€â”€ dashboard/
â”‚   â”‚   â”‚       â””â”€â”€ page.tsx      # Admin ëŒ€ì‹œë³´ë“œ
â”‚   â”‚   â””â”€â”€ instructor/
â”‚   â”‚       â”œâ”€â”€ page.tsx          # Instructor ë¡œê·¸ì¸
â”‚   â”‚       â””â”€â”€ dashboard/
â”‚   â”‚           â””â”€â”€ page.tsx      # Instructor ëŒ€ì‹œë³´ë“œ
â”‚   â”œâ”€â”€ course/
â”‚   â”‚   â””â”€â”€ [uuid]/
â”‚   â”‚       â”œâ”€â”€ page.tsx          # í•™ìƒ ì¸ì¦
â”‚   â”‚       â”œâ”€â”€ profile/
â”‚   â”‚       â”‚   â””â”€â”€ page.tsx      # í”„ë¡œí•„ ì…ë ¥/ìˆ˜ì •
â”‚   â”‚       â””â”€â”€ team/
â”‚   â”‚           â””â”€â”€ page.tsx      # íŒ€ ê²°ê³¼ í™•ì¸
â”‚   â”œâ”€â”€ api/                      # API Routes
â”‚   â”‚   â”œâ”€â”€ admin/
â”‚   â”‚   â”‚   â”œâ”€â”€ login/route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ instructors/route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ instructors/[id]/route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ students/[id]/reset-pin/route.ts
â”‚   â”‚   â”‚   â””â”€â”€ courses/route.ts
â”‚   â”‚   â”œâ”€â”€ instructor/
â”‚   â”‚   â”‚   â”œâ”€â”€ login/route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ courses/route.ts
â”‚   â”‚   â”‚   â””â”€â”€ courses/[id]/
â”‚   â”‚   â”‚       â”œâ”€â”€ route.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ students/route.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ lock/route.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ match/route.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ confirm/route.ts
â”‚   â”‚   â”‚       â””â”€â”€ teams/route.ts
â”‚   â”‚   â”œâ”€â”€ student/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/route.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ profile/route.ts
â”‚   â”‚   â”‚   â””â”€â”€ team/route.ts
â”‚   â”‚   â””â”€â”€ course/
â”‚   â”‚       â””â”€â”€ [uuid]/
â”‚   â”‚           â””â”€â”€ status/route.ts
â”‚   â”œâ”€â”€ layout.tsx
â”‚   â”œâ”€â”€ page.tsx                  # ëœë”© (ë¦¬ë‹¤ì´ë ‰íŠ¸)
â”‚   â””â”€â”€ globals.css
â”œâ”€â”€ components/                   # ì¬ì‚¬ìš© ì»´í¬ë„ŒíŠ¸
â”‚   â”œâ”€â”€ ui/                       # shadcn/ui ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ button.tsx
â”‚   â”‚   â”œâ”€â”€ input.tsx
â”‚   â”‚   â”œâ”€â”€ select.tsx
â”‚   â”‚   â”œâ”€â”€ card.tsx
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ forms/                    # í¼ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ LoginForm.tsx
â”‚   â”‚   â”œâ”€â”€ ProfileForm.tsx
â”‚   â”‚   â””â”€â”€ CourseForm.tsx
â”‚   â”œâ”€â”€ layouts/                  # ë ˆì´ì•„ì›ƒ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ AdminLayout.tsx
â”‚   â”‚   â”œâ”€â”€ InstructorLayout.tsx
â”‚   â”‚   â””â”€â”€ StudentLayout.tsx
â”‚   â””â”€â”€ shared/                   # ê³µí†µ ì»´í¬ë„ŒíŠ¸
â”‚       â”œâ”€â”€ Loading.tsx
â”‚       â”œâ”€â”€ ErrorBoundary.tsx
â”‚       â””â”€â”€ Toast.tsx
â”œâ”€â”€ lib/                          # ìœ í‹¸ë¦¬í‹°
â”‚   â”œâ”€â”€ supabase/
â”‚   â”‚   â”œâ”€â”€ client.ts             # ë¸Œë¼ìš°ì €ìš© í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â””â”€â”€ server.ts             # ì„œë²„ìš© í´ë¼ì´ì–¸íŠ¸
â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”œâ”€â”€ jwt.ts                # JWT ìƒì„±/ê²€ì¦
â”‚   â”‚   â”œâ”€â”€ hash.ts               # bcrypt í•´ì‹±
â”‚   â”‚   â””â”€â”€ middleware.ts         # ì¸ì¦ ë¯¸ë“¤ì›¨ì–´
â”‚   â”œâ”€â”€ matching/
â”‚   â”‚   â”œâ”€â”€ algorithm.ts          # ë§¤ì¹­ ì•Œê³ ë¦¬ì¦˜
â”‚   â”‚   â”œâ”€â”€ scoring.ts            # ì ìˆ˜ ê³„ì‚°
â”‚   â”‚   â””â”€â”€ optimizer.ts          # ìµœì í™” ë¡œì§
â”‚   â”œâ”€â”€ validators/
â”‚   â”‚   â”œâ”€â”€ auth.ts               # ì¸ì¦ ê²€ì¦
â”‚   â”‚   â”œâ”€â”€ profile.ts            # í”„ë¡œí•„ ê²€ì¦
â”‚   â”‚   â””â”€â”€ course.ts             # ì½”ìŠ¤ ê²€ì¦
â”‚   â””â”€â”€ constants/
â”‚       â”œâ”€â”€ weights.ts            # ê°€ì¤‘ì¹˜ í”„ë¡œíŒŒì¼
â”‚       â”œâ”€â”€ enums.ts              # Enum ì •ì˜
â”‚       â””â”€â”€ errors.ts             # ì—ëŸ¬ ì½”ë“œ
â”œâ”€â”€ types/                        # TypeScript íƒ€ì…
â”‚   â”œâ”€â”€ database.ts               # DB ìŠ¤í‚¤ë§ˆ íƒ€ì…
â”‚   â”œâ”€â”€ api.ts                    # API Request/Response
â”‚   â””â”€â”€ auth.ts                   # Auth ê´€ë ¨ íƒ€ì…
â”œâ”€â”€ hooks/                        # Custom Hooks
â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â”œâ”€â”€ useCourse.ts
â”‚   â””â”€â”€ useProfile.ts
â”œâ”€â”€ middleware.ts                 # Next.js Middleware
â”œâ”€â”€ next.config.js
â”œâ”€â”€ tailwind.config.js
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ package.json
â””â”€â”€ .env.local                    # í™˜ê²½ë³€ìˆ˜
```

---

## 4. Component Architecture

### 4.1 ì»´í¬ë„ŒíŠ¸ ê³„ì¸µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Pages                                 â”‚
â”‚  (app/*/page.tsx - ë¼ìš°íŒ…, ë°ì´í„° í˜ì¹­, ë ˆì´ì•„ì›ƒ ì¡°í•©)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Layouts                                 â”‚
â”‚  (components/layouts/* - ì—­í• ë³„ ê³µí†µ ë ˆì´ì•„ì›ƒ)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Feature Components                         â”‚
â”‚  (components/forms/*, ë„ë©”ì¸ íŠ¹í™” ì»´í¬ë„ŒíŠ¸)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    UI Components                             â”‚
â”‚  (components/ui/* - shadcn/ui ê¸°ë°˜ ì›ì ì»´í¬ë„ŒíŠ¸)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 ìƒíƒœ ê´€ë¦¬

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    State Strategy                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Server State:  React Query (or SWR) - API ë°ì´í„° ìºì‹±      â”‚
â”‚  Client State:  React useState/useReducer - UI ìƒíƒœ         â”‚
â”‚  Form State:    React Hook Form - í¼ ìƒíƒœ ê´€ë¦¬              â”‚
â”‚  Auth State:    Context API + JWT Cookie                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. API Architecture

### 5.1 API Route íŒ¨í„´

```typescript
// í‘œì¤€ API Response í˜•ì‹
interface ApiResponse<T> {
  success: boolean;
  data?: T;
  error?: {
    code: string;    // AUTH_001, COURSE_001 ë“±
    message: string;
  };
}

// í‘œì¤€ API Handler íŒ¨í„´
export async function POST(request: Request) {
  try {
    // 1. ì¸ì¦ ê²€ì¦
    const auth = await verifyAuth(request);
    if (!auth.valid) {
      return Response.json({ 
        success: false, 
        error: { code: 'AUTH_003', message: 'ì¸ì¦ ì‹¤íŒ¨' } 
      }, { status: 401 });
    }
    
    // 2. ì…ë ¥ ê²€ì¦
    const body = await request.json();
    const validated = schema.parse(body);
    
    // 3. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
    const result = await businessLogic(validated);
    
    // 4. ì‘ë‹µ
    return Response.json({ success: true, data: result });
    
  } catch (error) {
    // 5. ì—ëŸ¬ ì²˜ë¦¬
    return handleError(error);
  }
}
```

### 5.2 ë¯¸ë“¤ì›¨ì–´ ì²´ì¸

```
Request
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Rate Limiting  â”‚  (ì„ íƒì )
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  JWT Validation â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Role Check     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Input Validate â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    API Handler
```

---

## 6. Database Architecture

### 6.1 í…Œì´ë¸” ê´€ê³„ë„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   instructors   â”‚
â”‚  (êµìˆ˜ì ì •ë³´)   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ instructor_id   â”‚â”€â”€â”€â”€â”€â”
â”‚ email           â”‚     â”‚
â”‚ pin_hash        â”‚     â”‚
â”‚ name            â”‚     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
                        â”‚ 1:N
                        â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚     courses     â”‚
                â”‚   (ì½”ìŠ¤ ì •ë³´)    â”‚
                â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
          â”Œâ”€â”€â”€â”€â”€â”‚ course_id       â”‚â”€â”€â”€â”€â”€â”
          â”‚     â”‚ instructor_id   â”‚     â”‚
          â”‚     â”‚ course_name     â”‚     â”‚
          â”‚     â”‚ status          â”‚     â”‚
          â”‚     â”‚ deadline        â”‚     â”‚
          â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
          â”‚                             â”‚
          â”‚ 1:N                         â”‚ 1:N
          â–¼                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     teams       â”‚             â”‚    students     â”‚
â”‚   (íŒ€ ì •ë³´)      â”‚             â”‚   (í•™ìƒ ì •ë³´)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ team_id         â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ student_id      â”‚
â”‚ course_id       â”‚             â”‚ course_id       â”‚
â”‚ team_number     â”‚    N:1      â”‚ team_id (FK)    â”‚
â”‚ score_*         â”‚             â”‚ student_number  â”‚
â”‚ top_factors     â”‚             â”‚ profile fields  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 ì¸ë±ìŠ¤ ì „ëµ

```sql
-- ë¹ ë¥¸ ì¡°íšŒë¥¼ ìœ„í•œ ì¸ë±ìŠ¤
CREATE INDEX idx_courses_instructor ON courses(instructor_id);
CREATE INDEX idx_courses_status ON courses(status);
CREATE INDEX idx_students_course ON students(course_id);
CREATE INDEX idx_students_team ON students(team_id);
CREATE UNIQUE INDEX idx_students_number_course ON students(course_id, student_number);
CREATE INDEX idx_teams_course ON teams(course_id);
```

---

## 7. Security Architecture

### 7.1 ì¸ì¦ íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    JWT Token Flow                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Login Request                                               â”‚
â”‚       â”‚                                                      â”‚
â”‚       â–¼                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Validate   â”‚â”€â”€â”€â–¶â”‚  Generate   â”‚â”€â”€â”€â–¶â”‚  Set Cookie â”‚     â”‚
â”‚  â”‚ Credentials â”‚    â”‚    JWT      â”‚    â”‚  (httpOnly) â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                              â”‚
â”‚  Subsequent Requests                                         â”‚
â”‚       â”‚                                                      â”‚
â”‚       â–¼                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Extract    â”‚â”€â”€â”€â–¶â”‚   Verify    â”‚â”€â”€â”€â–¶â”‚  Authorize  â”‚     â”‚
â”‚  â”‚   Cookie    â”‚    â”‚    JWT      â”‚    â”‚    Role     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 JWT Payload êµ¬ì¡°

```typescript
// Admin JWT
interface AdminJWT {
  role: 'admin';
  email: string;
  exp: number;  // 4ì‹œê°„
  iat: number;
}

// Instructor JWT
interface InstructorJWT {
  role: 'instructor';
  instructorId: string;
  email: string;
  exp: number;  // 24ì‹œê°„
  iat: number;
}

// Student JWT
interface StudentJWT {
  role: 'student';
  studentId: string;
  courseId: string;
  studentNumber: string;
  exp: number;  // 24ì‹œê°„
  iat: number;
}
```

### 7.3 ì ‘ê·¼ ì œì–´ ë§¤íŠ¸ë¦­ìŠ¤

| Endpoint | Admin | Instructor | Student |
|----------|-------|------------|---------|
| `GET /api/admin/*` | âœ… | âŒ | âŒ |
| `POST /api/admin/*` | âœ… | âŒ | âŒ |
| `GET /api/instructor/courses` | âŒ | âœ… (ë³¸ì¸) | âŒ |
| `POST /api/instructor/courses/:id/match` | âŒ | âœ… (ë³¸ì¸) | âŒ |
| `GET /api/student/profile` | âŒ | âŒ | âœ… (ë³¸ì¸) |
| `GET /api/student/team` | âŒ | âŒ | âœ… (ë³¸ì¸) |
| `GET /api/course/:uuid/status` | âŒ | âŒ | âœ… |

---

## 8. Deployment Architecture

### 8.1 Vercel ë°°í¬ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Vercel                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚   Edge      â”‚    â”‚  Serverless â”‚    â”‚   Static    â”‚     â”‚
â”‚  â”‚  Network    â”‚â”€â”€â”€â–¶â”‚  Functions  â”‚    â”‚   Assets    â”‚     â”‚
â”‚  â”‚   (CDN)     â”‚    â”‚  (API)      â”‚    â”‚  (Next.js)  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                            â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Supabase                                â”‚
â”‚                   (PostgreSQL)                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8.2 í™˜ê²½ êµ¬ì„±

```
Environments:
â”œâ”€â”€ Development (local)
â”‚   â””â”€â”€ .env.local
â”œâ”€â”€ Preview (PR branches)
â”‚   â””â”€â”€ Vercel Preview
â””â”€â”€ Production (main branch)
    â””â”€â”€ Vercel Production
```

---

## 9. Error Handling Strategy

### 9.1 ì—ëŸ¬ ê³„ì¸µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Error Hierarchy                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  AppError (Base)                                             â”‚
â”‚      â”‚                                                       â”‚
â”‚      â”œâ”€â”€ AuthError                                           â”‚
â”‚      â”‚     â”œâ”€â”€ AUTH_001 (ì˜ëª»ëœ í•™ë²ˆ í˜•ì‹)                   â”‚
â”‚      â”‚     â”œâ”€â”€ AUTH_002 (ì˜ëª»ëœ PIN í˜•ì‹)                    â”‚
â”‚      â”‚     â””â”€â”€ AUTH_003 (ì¸ì¦ ì‹¤íŒ¨)                          â”‚
â”‚      â”‚                                                       â”‚
â”‚      â”œâ”€â”€ CourseError                                         â”‚
â”‚      â”‚     â”œâ”€â”€ COURSE_001 (ì½”ìŠ¤ ì—†ìŒ)                        â”‚
â”‚      â”‚     â””â”€â”€ COURSE_002 (ë§ˆê°ë¨)                           â”‚
â”‚      â”‚                                                       â”‚
â”‚      â””â”€â”€ MatchError                                          â”‚
â”‚            â”œâ”€â”€ MATCH_001 (í•™ìƒ ë¶€ì¡±)                         â”‚
â”‚            â””â”€â”€ MATCH_002 (ì´ë¯¸ í™•ì •ë¨)                       â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.2 í´ë¼ì´ì–¸íŠ¸ ì—ëŸ¬ ì²˜ë¦¬

```typescript
// ì „ì—­ ì—ëŸ¬ í•¸ë“¤ëŸ¬
function handleApiError(error: ApiError) {
  switch (error.code) {
    case 'AUTH_003':
      redirect('/login');
      break;
    case 'COURSE_002':
      toast.error('í”„ë¡œí•„ ì…ë ¥ ë§ˆê°ê¸°í•œì´ ì§€ë‚¬ìŠµë‹ˆë‹¤.');
      break;
    default:
      toast.error(error.message);
  }
}
```

---

## 10. Performance Considerations

### 10.1 ìµœì í™” ì „ëµ

| ì˜ì—­ | ì „ëµ |
|------|------|
| **Database** | ì¸ë±ìŠ¤, ì¿¼ë¦¬ ìµœì í™”, Connection Pooling |
| **API** | Edge Functions, ì‘ë‹µ ìºì‹± |
| **Frontend** | Code Splitting, Image Optimization, SSG/ISR |
| **Matching** | ì•Œê³ ë¦¬ì¦˜ ì‹œê°„ë³µì¡ë„ O(nÂ²) ì´í•˜ ìœ ì§€ |

### 10.2 ì„±ëŠ¥ ëª©í‘œ

| ë©”íŠ¸ë¦­ | ëª©í‘œ |
|--------|------|
| í˜ì´ì§€ ë¡œë“œ (LCP) | < 2.5s |
| API ì‘ë‹µ ì‹œê°„ | < 200ms |
| ë§¤ì¹­ ì‹¤í–‰ ì‹œê°„ | < 3s (50ëª… ê¸°ì¤€) |
| Lighthouse Score | > 90 |

---

## 11. Dependency Map

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Dependencies                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Production:                                                 â”‚
â”‚  â”œâ”€â”€ next (14.x)                                            â”‚
â”‚  â”œâ”€â”€ react (18.x)                                           â”‚
â”‚  â”œâ”€â”€ @supabase/supabase-js                                  â”‚
â”‚  â”œâ”€â”€ jose (JWT)                                             â”‚
â”‚  â”œâ”€â”€ bcryptjs (í•´ì‹±)                                        â”‚
â”‚  â”œâ”€â”€ zod (ê²€ì¦)                                             â”‚
â”‚  â”œâ”€â”€ tailwindcss                                            â”‚
â”‚  â””â”€â”€ @radix-ui/* (shadcn/ui ê¸°ë°˜)                           â”‚
â”‚                                                              â”‚
â”‚  Development:                                                â”‚
â”‚  â”œâ”€â”€ typescript                                              â”‚
â”‚  â”œâ”€â”€ eslint                                                  â”‚
â”‚  â”œâ”€â”€ prettier                                                â”‚
â”‚  â””â”€â”€ @types/*                                                â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**END OF DOCUMENT**

*ì´ ë¬¸ì„œëŠ” PRD.mdë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ëª…ì„¸ì…ë‹ˆë‹¤.*
